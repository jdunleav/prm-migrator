version: 0.2

phases:
  install:
    commands:
      - apt-get update
      - apt-get install -y jq zip unzip # nodejs npm
  pre_build:
    commands:
      - chmod a+x ./utils/*
  build:
    commands:
      # Installing npm packages 
      - curl -sL https://deb.nodesource.com/setup_11.x | bash -
      - sudo apt-get install nodejs build-essential
      - npm -v
      - node -v
      - cd ./dynamo
      - pwd
      - npm install
      - cd -
      - pwd
      # Running Owasp dependency-check
      - cd $TMPDIR; wget -nv https://dl.bintray.com/jeremy-long/owasp/dependency-check-4.0.2-release.zip; unzip -q dependency-check-4.0.2-release.zip
      - ./dependency-check/bin/dependency-check.sh  --project secscaprj --enableRetired --scan $CODEBUILD_SRC_DIR
