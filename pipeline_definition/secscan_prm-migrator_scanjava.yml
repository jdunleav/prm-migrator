version: 0.2

phases:
  install:
    commands:
      - apt-get update
      - apt-get install -y jq zip unzip # nodejs npm
  pre_build:
    commands:
      - chmod a+x ./utils/*
  build:
    commands:
      # Installing npm packages 
      - wget -qO- https://raw.githubusercontent.com/creationix/nvm/v0.34.0/install.sh | bash
      - export NVM_DIR="$HOME/.nvm"
      - node -v
      - npm -v
      - npm install -g recursive-install
      - # cd ./dynamo; npm install 
      # Running Owasp dependency-check
      - cd $TMPDIR; wget -nv https://dl.bintray.com/jeremy-long/owasp/dependency-check-4.0.2-release.zip; unzip -q dependency-check-4.0.2-release.zip
      - ./dependency-check/bin/dependency-check.sh  --project secscaprj --enableRetired --scan $CODEBUILD_SRC_DIR
